# 指导老师选择修复 - 快速测试清单

**修复版本**: v0.9.1-hotfix  
**测试时间**: 2025-12-27  

---

## ✅ 修复完成

### 修改内容
- [x] `club_web/src/views/club/ClubList.vue` - 扩展指导老师角色筛选
- [x] 新增支持: `DEPT_ADMIN` (院系管理员)
- [x] 新增支持: `ADVISOR` (指导老师角色)

---

## 🧪 快速测试

### 步骤1: 刷新前端
```bash
# 清除浏览器缓存
Ctrl + Shift + R (Windows)
Cmd + Shift + R (Mac)
```

### 步骤2: 测试指导老师选择
1. 登录管理员账号 (admin / 123456)
2. 进入"社团信息管理"
3. 点击"创建新社团"或点击某个社团的"编辑"
4. 查看"指导老师"下拉框

**验证点**:
- ✅ 显示系统管理员 (SYS_ADMIN)
- ✅ 显示教师 (TEACHER)
- ✅ 显示院系管理员 (DEPT_ADMIN) ⭐ 新增
- ✅ 显示指导老师 (ADVISOR) ⭐ 新增
- ❌ 不显示学生 (STUDENT)

### 步骤3: 保存验证
1. 选择一个院系管理员作为指导老师
2. 保存社团信息
3. 检查社团列表中"指导老师"列是否正确显示

---

## 📊 修复前后对比

### 修复前
```javascript
// 只能选择这两种角色
u.roleKey === 'TEACHER' || u.roleKey === 'SYS_ADMIN'
```
下拉框选项: 教师、系统管理员

### 修复后
```javascript
// 可以选择四种角色
u.roleKey === 'TEACHER' || 
u.roleKey === 'SYS_ADMIN' || 
u.roleKey === 'DEPT_ADMIN' ||  // 新增
u.roleKey === 'ADVISOR'        // 新增
```
下拉框选项: 教师、系统管理员、院系管理员、指导老师

---

## 🔍 验证数据

### 检查数据库中的角色分布
```sql
SELECT role_key, COUNT(*) as count, GROUP_CONCAT(real_name) as users
FROM sys_user
WHERE role_key IN ('SYS_ADMIN', 'DEPT_ADMIN', 'TEACHER', 'ADVISOR')
GROUP BY role_key;
```

### 如果缺少测试用户
```sql
-- 创建一个院系管理员用于测试
INSERT INTO sys_user (username, password, real_name, role_key, dept_id, status)
VALUES ('dept_admin1', '123456', '李院长', 'DEPT_ADMIN', 1, 1);

-- 或将现有用户改为院系管理员
UPDATE sys_user 
SET role_key = 'DEPT_ADMIN' 
WHERE user_id = 3;
```

---

## ⚠️ 注意事项

1. **仅前端修改**: 无需重启后端服务
2. **刷新浏览器**: 必须清除缓存后重新加载
3. **数据要求**: 数据库中需要有相应角色的用户才能看到效果

---

## 📝 测试结果记录

测试人: ___________  
测试时间: ___________

- [ ] 院系管理员出现在下拉列表
- [ ] 可以成功选择院系管理员
- [ ] 保存后正确显示
- [ ] 其他功能无影响

问题记录:
_____________________________

---

## 📞 问题排查

**Q: 下拉框还是没有院系管理员?**
1. 检查是否刷新了浏览器缓存
2. 检查数据库是否有 role_key='DEPT_ADMIN' 的用户
3. 检查浏览器 Console 是否有错误

**Q: 如何验证修复成功?**
- 方法1: 查看下拉框选项数量是否增加
- 方法2: 在Console中执行: `console.log(teacherList.value)`
- 方法3: 查看网络请求返回的用户列表

---

详细文档: `指导老师选择范围修复说明-v0.9.1-hotfix.md`
